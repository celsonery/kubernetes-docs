import{_ as s,c as e,o as a,a as n}from"./app-h7mth2r0.js";const i={},t=n(`<h1 id="instalacao-no-debian" tabindex="-1"><a class="header-anchor" href="#instalacao-no-debian"><span>Instalação no Debian</span></a></h1><p>Carregue os modulos <strong>overlay</strong> e <strong>br_netfilter</strong></p><p>Crie o arquivo <strong>/etc/modules-load.d/containerd.conf</strong> para subir após o reboot</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">overlay</span>
<span class="line">br_netfilter</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Carregue manualmente</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ <span class="token function">sudo</span> modprobe overlay</span>
<span class="line">$ <span class="token function">sudo</span> modprobe br_netfilter</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Crie o arquivo /etc/sysctl.d/99-kubernetes-k8s.conf</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">net.bridge.bridge-nf-call-iptables <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">net.bridge.bridge-nf-call-ip6tables <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Carregue as configurações criadas</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ <span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">--system</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Instale o containerd</p><p>Instale o repositório do <strong>docker</strong> somente para fazer a instalação do <strong>containerd.io</strong></p><p>Baixe a chave gpg do repositório</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> gpg <span class="token parameter variable">--dearmor</span> <span class="token parameter variable">-o</span> /etc/apt/trusted.gpg.d/docker.gpg</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Crie um arquivo de repositório em <strong>/etc/apt/sources.list.d/</strong> com o nome <strong>docker.list</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">deb <span class="token punctuation">[</span>arch<span class="token operator">=</span>amd64<span class="token punctuation">]</span> https://download.docker.com/linux/debian bullseye stable</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Atualize a lista de pacotes e instale o <strong>containerd.io</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> update</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> containerd.io</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Sobreescreva o arquivo de configuração do containerd</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ <span class="token function">sudo</span> containerd config default <span class="token operator">&gt;</span> /etc/containerd/config.toml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Edite o arquivo <strong>/etc/containerd/config.toml</strong> e altere a opção <strong>SystemdCgroup</strong> de <strong>false</strong> para <strong>true</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/containerd/config.toml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Restarte o containerd</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> systemctl restart containerd</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Instale o Kubernetes</p><p>Adicione a chave gpg do repositório do kubernetes</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://pkgs.k8s.io/core:/stable:/v1.31/deb/Release.key <span class="token parameter variable">-o</span> /etc/apt/trusted.gpg.d/kubernetes-gpg-keyring.asc</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Adicione o repositório do kubernetes</p><p>Crie o arquivo: <strong>/etc/apt/sources.list.d/kubernetes.list</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">deb <span class="token punctuation">[</span>signed-by<span class="token operator">=</span>/etc/apt/trusted.gpg.d/kubernetes-gpg-keyring.gpg<span class="token punctuation">]</span> http://pkgs.k8s.io/core:/stable:/v1.31/deb /&quot;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h3><p>Atualize a lista de pacotes</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> update</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Instale o kubernetes</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> kubelet kubeadm</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Marque os pacotes para prevenir modificações.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> apt-mark hold kubelet kubeadm</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Ative o daemon para iniciar automaticamente</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> kubelet</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Limitar armazenamento de imagens</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">vim</span> /var/lib/kubelet/kubeadm-flags.env</span>
<span class="line"></span>
<span class="line">--image-gc-high-threshold<span class="token operator">=</span><span class="token number">60</span> --image-gc-low-threshold<span class="token operator">=</span><span class="token number">50</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,41),l=[t];function r(d,o){return a(),e("div",null,l)}const c=s(i,[["render",r],["__file","02-install-kubernetes.html.vue"]]),u=JSON.parse('{"path":"/br/kubernetes/02-install-kubernetes.html","title":"Instalação no Debian","lang":"Português","frontmatter":{},"headers":[{"level":3,"title":"","slug":"","link":"#","children":[]}],"git":{"updatedTime":1748002949000,"contributors":[{"name":"Celso Nery","email":"celso.nery@gmail.com","commits":1}]},"filePathRelative":"br/kubernetes/02-install-kubernetes.md"}');export{c as comp,u as data};
